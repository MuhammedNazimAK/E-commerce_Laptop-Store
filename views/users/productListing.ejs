<%- include("../partials/user/header") %>
<%- include("../partials/user/right") %>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/14.6.3/nouislider.min.css">


<style>
  .slider-range {
  transform: translate(0%) scale(0.432191, 1);
  color: blue;
  background-color: #b19361;
}
  #product-container {
  padding-left: 5px; /* Moves the entire container to the right */
}
.product-unavailable {
  color: red;
  font-weight: bold;
  display: block;
  margin: 10px 0;
}

.product-list-single {
  display: flex;
  margin-bottom: 30px;
  align-items: flex-start;
}

.product-list-img-link {
  flex: 0 0 260px;
  margin-right: 10px;
  background-color: #fef5ef;  
}

.product-list-content {
  flex: 1;
  padding-top: 60px;
}

.product-action-icon-link-list {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-top: 20px;
}

.btn-lg {
  padding: 10px 15px;
  font-size: 14px;
}
.add-to-wishlist.added-to-wishlist {
  color: red;
}
</style>

    <!-- ...:::: Start Breadcrumb Section:::... -->
    <div class="breadcrumb-section breadcrumb-bg-color--golden">
        <div class="breadcrumb-wrapper">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <h3 class="breadcrumb-title">Shop</h3>
                        <div class="breadcrumb-nav breadcrumb-nav-color--black breadcrumb-nav-hover-color--golden">
                            <nav aria-label="breadcrumb">
                                <ul>
                                    <li><a href="home">Home</a></li>
                                    <li><a href="productListing">Shop</a></li>
                                    <li class="active" aria-current="page">Products</li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- ...:::: End Breadcrumb Section:::... -->

    <!-- ... -->
    <div class="shop-section">
        <div class="container">
          <div class="row flex-column-reverse flex-lg-row">
            <div class="col-lg-3">
              <!-- Start Sidebar Area -->
              <div class="siderbar-section" data-aos="fade-up" data-aos-delay="0">
                <!-- Sidebar Widgets -->
                <div class="sidebar-single-widget">
                  <h6 class="sidebar-title">FILTER BY PRICE</h6>
                  <div class="sidebar-content">
                    <div id="slider-range"></div>
                    <div class="filter-type-price">
                      <label for="min-price">Min Price:</label>
                      <input type="text" id="min-price" class="amount">
                      <label for="max-price">Max Price:</label>
                      <input type="text" id="max-price" class="amount">
                    </div>
                  </div>
                </div>
                <div class="sidebar-single-widget">
                  <h6 class="sidebar-title">MANUFACTURER</h6>
                  <div class="sidebar-content">
                    <div class="filter-type-select">
                      <ul>
                        <% brands.forEach(brand => { %>
                        <li>
                          <label class="checkbox-default" for="brand-<%= brand %>">
                            <input type="checkbox" id="brand-<%= brand %>" value="<%= brand %>" class="brand-filter"
                              <%= selectedBrand === brand ? 'checked' : '' %>>
                            <span><%= brand %></span>
                          </label>
                        </li>
                        <% }) %>
                      </ul>
                    </div>
                  </div>
                </div>
                
                <div class="sidebar-single-widget">
                  <h6 class="sidebar-title">SELECT BY CATEGORY</h6>
                  <div class="sidebar-content">
                    <div class="filter-type-select">
                      <ul>
                        <% categories.forEach(category => { %>
                        <li>
                          <label class="checkbox-default" for="category-<%= category._id %>">
                            <input type="checkbox" id="category-<%= category._id %>" value="<%= category._id %>" class="category-filter"
                              <%= selectedCategory === category._id ? 'checked' : '' %>>
                            <span><%= category.name %></span>
                          </label>
                        </li>
                        <% }) %>
                      </ul>
                    </div>
                  </div>
                </div>
                
                <div class="sidebar-single-widget">
                    <h6 class="sidebar-title">SELECT BY RAM</h6>
                    <div class="sidebar-content">
                      <div class="filter-type-select">
                        <ul>
                          <% rams.forEach(ram => { %>
                          <li>
                            <label class="checkbox-default" for="ram-<%= ram.replace(/\s/g, '-') %>">
                              <input type="checkbox" id="ram-<%= ram.replace(/\s/g, '-') %>" value="<%= ram %>" class="ram-filter">
                              <span><%= ram %></span>
                            </label>
                          </li>
                          <% }) %>
                        </ul>
                      </div>
                    </div>
                  </div>
                <div class="sidebar-single-widget">
                  <h6 class="sidebar-title">SELECT BY PROCESSOR</h6>
                  <div class="sidebar-content">
                    <div class="filter-type-select">
                      <ul>
                        <% processors.forEach(processor => { %>
                        <li>
                          <label class="checkbox-default" for="processor-<%= processor.replace(/\s/g, '-') %>">
                            <input type="checkbox" id="processor-<%= processor.replace(/\s/g, '-') %>" value="<%= processor %>" class="processor-filter">
                            <span><%= processor %></span>
                          </label>
                        </li>
                        <% }) %>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="sidebar-single-widget">
                    <h6 class="sidebar-title">SELECT BY GRAPHICS CARD</h6>
                    <div class="sidebar-content">
                      <div class="filter-type-select">
                        <ul>
                          <% graphicsCards.forEach(graphicsCard => { %>
                          <li>
                            <label class="checkbox-default" for="graphics-card-<%= graphicsCard.replace(/\s/g, '-') %>">
                              <input type="checkbox" id="graphics-card-<%= graphicsCard.replace(/\s/g, '-') %>" value="<%= graphicsCard %>" class="graphics-card-filter">
                              <span><%= graphicsCard %></span>
                            </label>
                          </li>
                          <% }) %>
                        </ul>
                      </div>
                    </div>
                </div>
                <!-- <div class="sidebar-single-widget">
                  <h6 class="sidebar-title">SELECT BY RATING</h6>
                  <div class="sidebar-content">
                    <div class="filter-type-select">
                      <ul>
                        <li>
                          <label class="checkbox-default" for="rating-filter">
                            <input type="number" id="rating-filter" min="1" max="5" step="0.1" class="rating-filter">
                            <span>Rating (min)</span>
                          </label>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="sidebar-single-widget">
                  <div class="sidebar-content">
                    <div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" role="switch" id="featured-filter">
                      <label class="form-check-label" for="featured-filter">Featured</label>
                    </div>
                    <div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" role="switch" id="new-arrivals-filter">
                      <label class="form-check-label" for="new-arrivals-filter">New Arrivals</label>
                    </div>
                  </div>
                </div> -->
              </div>
            </div>
            <div class="col-lg-9">
              <!-- Start Shop Product Sorting Section -->
              <div class="shop-sort-section">
                <div class="container">
                  <div class="row">
                    <div class="sort-box d-flex justify-content-between align-items-md-center align-items-start flex-md-row flex-column"
                      data-aos="fade-up" data-aos-delay="0">
                      <div class="sort-tablist d-flex align-items-center">
                        <div class="page-amount ml-2">
                          <span id="product-count">Showing 1â€“9 of 21 results</span>
                        </div>
                      </div>
                      <div class="sort-select-list d-flex align-items-center">
                        <label class="mr-2">Sort By:</label>
                        <form action="#">
                          <fieldset>
                            <select name="sort" id="sort-select" class="sort-select">
                              <option value="createdAt">Sort by newness</option>
                              <option value="popularity">Sort by popularity</option>
                              <option value="priceAsc">Sort by price: low to high</option>
                              <option value="priceDesc">Sort by price: high to low</option>
                              <option value="ratingDesc">Sort by rating</option>
                              <option value="featured">Sort by featured</option>
                              <option value="nameAsc">Product Name: A-Z</option>
                              <option value="nameDesc">Product Name: Z-A</option>
                            </select>
                          </fieldset>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Start Tab Wrapper -->
              <div class="sort-product-tab-wrapper product-default-slider-section section-fluid" data-aos="fade-up" data-aos-delay="0">
                <div class="container">
                  <div class="row">
                    <div class="col-12">
                      <div class="tab-content tab-animate-zoom">
                        <div class="tab-pane active show sort-layout-single" id="layout-list">
                          <div class="row" id="product-container">
                            <!-- Product listings will be dynamically rendered here -->
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>


      <div class="page-pagination text-center" data-aos="fade-up" data-aos-delay="0">
        <ul class="pagination justify-content-center" id="pagination-container">
          <!-- Pagination will be dynamically inserted here -->
        </ul>
      </div>


  
      
      
      
      
      
      <%- include("../partials/user/footer") %> 
      <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/14.6.3/nouislider.min.js"></script>
      <script src="/javascript/productListing.js"></script>
      <script>
        document.addEventListener('DOMContentLoaded', function() {
        const urlParams = new URLSearchParams(window.location.search);
        const selectedBrand = urlParams.get('brand');
        const selectedCategory = urlParams.get('category');

        if (selectedBrand) {
          document.querySelector(`input[name="brand"][value="${selectedBrand}"]`).checked = true;
        }

        if (selectedCategory) {
          document.querySelector(`input[name="category"][value="${selectedCategory}"]`).checked = true;
        }

        // Trigger your existing filter function here if needed
        fetchProducts();
      });
      </script>
      <script src="/javascript/wishlist.js" defer></script>
