<%- include("../partials/user/header") %>
<%- include("../partials/user/right") %>


    <style>
        .error-message {
            color: black;
            font-size: 12px;
            position: absolute;
            left: 0;
            bottom: -20px;
        }
        .default-form-box {
            position: relative;
        }

    </style>

    <!-- ...:::: Start Breadcrumb Section:::... -->
    <div class="breadcrumb-section breadcrumb-bg-color--golden">
        <div class="breadcrumb-wrapper">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <h3 class="breadcrumb-title">My Account</h3>
                        <div class="breadcrumb-nav breadcrumb-nav-color--black breadcrumb-nav-hover-color--golden">
                            <nav aria-label="breadcrumb">
                                <ul>
                                    <li><a href="/home">Home</a></li>
                                    <li><a href="shop-grid-sidebar-left.html">Shop</a></li>
                                    <li class="active" aria-current="page">My Account</li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- ...:::: End Breadcrumb Section:::... -->

    <!-- Start Account Dashboard Section -->
<div class="account-dashboard">
    <div class="container">
        <div class="row">
            <div class="col-sm-12 col-md-3 col-lg-3">
                <!-- Nav tabs -->
                <div class="dashboard_tab_button" data-aos="fade-up" data-aos-delay="0">
                    <ul role="tablist" class="nav flex-column dashboard-list">
                        <li><a href="#dashboard" data-bs-toggle="tab" class="nav-link btn btn-block btn-md btn-black-default-hover active">Dashboard</a></li>
                        <li><a href="#orders" data-bs-toggle="tab" class="nav-link btn btn-block btn-md btn-black-default-hover">Orders</a></li>
                        <li><a href="#wallet" data-bs-toggle="tab" class="nav-link btn btn-block btn-md btn-black-default-hover">Wallet</a></li>
                        <li><a href="#address" data-bs-toggle="tab" class="nav-link btn btn-block btn-md btn-black-default-hover">Addresses</a></li>
                        <li><a href="#account-details" data-bs-toggle="tab" class="nav-link btn btn-block btn-md btn-black-default-hover">Account details</a></li>
                        
                        <% if (userLoggedIn) { %>
                            <li>
                                <form action="/logout" method="post">
                                    <button type="submit" class="nav-link btn btn-block btn-md btn-black-default-hover">Logout</button>
                                </form>
                            </li>
                        <% } %>
                    </ul>
                </div>
            </div>
            <div class="col-sm-12 col-md-9 col-lg-9">
                <!-- Tab panes -->
                <div class="tab-content dashboard_content" data-aos="fade-up" data-aos-delay="200">
                    
                    <div class="tab-pane fade show active" id="dashboard">
                        <h4>Welcome to Your Dashboard</h4>

                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Referral Program</h5>
                                        <% if (referralCode) { %>
                                            <p>
                                                <strong>Your Referral Code:</strong> 
                                                <span id="referralCode"><%= referralCode %></span>
                                                <button class="btn btn-sm btn-outline-secondary ml-2" id="copyReferralCode">
                                                    <i class="fas fa-copy"></i> Copy Code
                                                </button>
                                            </p>
                                            <p>
                                                <strong>Your Referral Link:</strong> 
                                                <span id="referralLink"><%= referralLink %></span>
                                                <button class="btn btn-sm btn-outline-secondary ml-2" id="copyReferralLink">
                                                    <i class="fas fa-copy"></i> Copy Link
                                                </button>
                                            </p>
                                        <% } else { %>
                                            <p><strong>Referral Program:</strong> Not available</p>
                                        <% } %>
                                        <p><strong>Referrals:</strong> <span id="referralCount"><%= referralCount %></span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- <div class="row">
                            <div class="col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Account Information</h5>
                                        <p><strong>Name:</strong> <span id="userFullName"></span></p>
                                        <p><strong>Email:</strong> <span id="userEmail"></span></p>
                                        <p><strong>Mobile:</strong> <span id="userMobile"></span></p>
                                        <a href="#" class="btn btn-md btn-black-default-hover">Edit Profile</a>
                                    </div>
                                </div>
                            </div> -->
                            
                            <!-- <div class="col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Wallet Balance</h5>
                                        <h3 class="text-success mb-3">â‚¹<span id="walletBalance">0.00</span></h3>
                                        <a href="#" class="btn btn-md btn-black-default-hover">View Transactions</a>
                                    </div>
                                </div>
                            </div> -->
                        <!-- </div> -->
                    
                        <div class="row">
                            <!-- <div class="col-md-4 mb-4">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Recent Orders</h5>
                                        <p class="card-text">Check your recent order status and details.</p>
                                        <a href="#" class="btn btn-md btn-black-default-hover">View Orders</a>
                                    </div>
                                </div>
                            </div> -->
                    
                            <div class="col-md-4 mb-4">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Wishlist</h5>
                                        <p class="card-text">Manage your wishlist items.</p>
                                        <a href="wishList" class="btn btn-md btn-black-default-hover">View Wishlist</a>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4 mb-4">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Cart</h5>
                                        <p class="card-text">View your cart items.</p>
                                        <a href="cart" class="btn btn-md btn-black-default-hover">View Cart</a>
                                    </div>
                                </div>
                            </div>                                                            

                            <!-- <div class="col-md-4 mb-4">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Addresses</h5>
                                        <p class="card-text">Manage your shipping and billing addresses.</p>
                                        <a href="#" class="btn btn-md btn-black-default-hover">Manage Addresses</a>
                                    </div>
                                </div>
                            </div> -->
                        </div>
                    
                            <!-- <div class="col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Recent Searches</h5>
                                        <ul class="list-unstyled" id="recentSearches">
                                            <!-- Recent searches will be populated here -->
                                        <!-- </ul>
                                        <a href="#" class="btn btn-md btn-black-default-hover">View All Searches</a>
                                    </div>
                                </div>
                            </div> -->
                        </div>

                    <div class="tab-pane fade" id="orders">
                        <h4>Orders</h4>
                        <div class="table_page table-responsive">
                          <table>
                            <thead>
                              <tr>
                                <th>Order</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Total</th>
                                <th>Actions</th>
                              </tr>
                            </thead>
                            <tbody id="orderTableBody">
                              <!-- Orders will be dynamically inserted here -->
                            </tbody>
                          </table>
                        </div>
                        <nav aria-label="Page navigation">
                            <ul class="pagination justify-content-center mt-4" id="ordersPagination">
                              <!-- Pagination will be dynamically inserted here -->
                            </ul>
                          </nav>
                      </div>

                      <!-- Order Details Modal -->
                        <div class="modal fade" id="orderDetailsModal" tabindex="-1" aria-labelledby="orderDetailsModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-lg modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header">
                                <h5 class="modal-title" id="orderDetailsModalLabel">Order Details</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                <div class="row">
                                    <div class="col-md-6">
                                    <h6>Order Information</h6>
                                    <p><strong>Order ID:</strong> <span id="orderId"></span></p>
                                    <p><strong>Order Date:</strong> <span id="orderDate"></span></p>
                                    <p><strong>Status:</strong> <span id="orderStatus"></span></p>
                                    <p><strong>Total:</strong> â‚¹<span id="orderTotal"></span></p>
                                    <p><strong>Payment Method:</strong> <span id="orderPayment"></span></p>
                                    <p><strong>Shipping Address:</strong> <span id="orderShippingAddress"></span></p>
                                    </div>
                                </div>
                                <div class="row mt-4">
                                    <div class="col-12">
                                    <h6>Order Items</h6>
                                    <table class="table table-striped">
                                        <thead>
                                        <tr>
                                            <th>Product</th>
                                            <th>Quantity</th>
                                            <th>Price</th>
                                            <th>Subtotal</th>
                                            <th>Actions</th>
                                        </tr>
                                        </thead>
                                        <tbody id="orderItemsTableBody">
                                        <!-- Order items will be dynamically inserted here -->
                                        </tbody>
                                    </table>
                                    </div>
                                </div>
                                </div>
                                <div class="modal-footer">
                                <button type="button" class="btn btn-md btn-black-default-hover" data-bs-dismiss="modal">Close</button>
                                </div>
                            </div>
                            </div>
                            <div id="confirmReturnModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered" role="document">
                                  <div class="modal-content">
                                    <div class="modal-header">
                                      <h5 class="modal-title">Confirm Return</h5>
                                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                      <p>Are you sure you want to return this product? You won't be able to revert this!</p>
                                    </div>
                                    <div class="modal-footer">
                                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                      <button type="button" class="btn btn-danger btn-black-default-hover" id="confirmReturnBtn">Yes, return it</button>
                                    </div>
                                  </div>
                                </div>
                              </div>                              
                        </div>

                        <div class="tab-pane fade" id="wallet">
                            <h4>My Wallet</h4>
                            <div id="walletBalance" style="font-size: 24px; font-weight: bold;"></div>
                            <div id="transactions" class="table_page table-responsive">
                              <h5>Transaction History</h5>
                              <table id="transactionTable">
                                <thead>
                                  <tr>
                                    <th>Date</th>
                                    <th>Type</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                    <th>Description</th>
                                  </tr>
                                </thead>
                                <tbody></tbody>
                              </table>
                            </div>
                            <nav aria-label="Page navigation">
                                <ul class="pagination justify-content-center mt-4" id="walletPagination">
                                  <!-- Pagination will be dynamically inserted here -->
                                </ul>
                              </nav>
                          </div>
                          
                    <div class="tab-pane fade" id="downloads">
                        <h4>Downloads</h4>
                        <div class="table_page table-responsive">   
                            <table>
                                <thead>
                                    <tr>
                                        <th>Product</th>
                                        <th>Downloads</th>
                                        <th>Expires</th>
                                        <th>Download</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Downloads data should be dynamically inserted here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="address">
                        <h4>Addresses</h4>
                        <div id="address-list">
                        <% if (addresses.length > 0) { %>
                            <div class="row">
                                <% addresses.forEach(user => { %>
                                    <% user.address.forEach(address => { %>
                                        <div class="col-md-6 mb-4">
                                            <div class="address-card p-3 border rounded">
                                                <h5><%= address.name %></h5>
                                                <p><strong>Type:</strong> <%= address.addressType %></p>
                                                <p><strong>City:</strong> <%= address.city %></p>
                                                <p><strong>Landmark:</strong> <%= address.landMark %></p>
                                                <p><strong>State:</strong> <%= address.state %></p>
                                                <p><strong>Pin Code:</strong> <%= address.pinCode %></p>
                                                <p><strong>Mobile:</strong> <%= address.mobile %></p>
                                                <button class="btn btn-md btn-black-default-hover edit-address" data-id="<%= address._id %>" data-bs-toggle="modal" data-bs-target="#editAddressModal">Edit</button>
                                                <button class="btn btn-md btn-black-default-hover delete-address" data-id="<%= address._id %>">Delete</button>
                                            </div>
                                        </div>
                                    <% }); %>
                                <% }); %>
                            </div>
                        <% } else { %>
                            <p>No addresses found.</p>
                        <% } %>
                        </div>
                        <a href="#" class="view mt-3" data-bs-toggle="modal" data-bs-target="#addAddressModal">Add Address</a>
                    </div>            
                    <!-- Flash Message Container -->
                    <div id="flashMessageContainer" class="position-fixed top-0 end-0 p-3" style="z-index: 11"></div>
                    <div class="tab-pane fade" id="account-details">
                        <h3>Account details</h3>
                        <% if (userLoggedIn) { %>
                            <div class="login">
                                <div class="login_form_container">
                                    <div class="account_login_form">
                                        <form id="updateProfileForm" action="/update-profile" method="post">
                                            <div class="default-form-box mb-20">
                                                <label>First Name</label>
                                                <input type="text" id="firstName" name="firstName" value="<%= user ? user.firstName : '' %>">
                                                <div id="firstNameError" class="error-message"></div>
                                            </div>
                                            <div class="default-form-box mb-20">
                                                <label>Last Name</label>
                                                <input type="text" id="lastName" name="lastName" value="<%= user ? user.lastName : '' %>">
                                                <div id="lastNameError" class="error-message"></div>
                                            </div>
                                            <div class="default-form-box mb-20">
                                                <label>Email</label>
                                                <input type="email" name="email" value="<%= user ? user.email : '' %>" readonly>
                                            </div>
                                            <div class="default-form-box mb-20">
                                                <label>Mobile</label>
                                                <input type="tel" id="mobileForProfile" name="mobile" value="<%= user ? user.mobile : '' %>">
                                                <div id="mobileError" class="error-message"></div>
                                            </div>
                                            <div class="save_button mt-3">
                                                <button class="btn btn-md btn-black-default-hover" type="submit">Save Changes</button>
                                            </div>
                                        </form>
                                        <a href="#" class="view" data-bs-toggle="modal" data-bs-target="#changePasswordModal">Change Password</a>
                                    </div>
                                </div>
                            </div>
                        <% } else { %>
                            <p>Already have an account? <a href="/login">Log in instead!</a></p>
                        <% } %>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div> <!-- End Account Dashboard Section -->

    
        <!-- Add Address Modal -->
        <div class="modal fade" id="addAddressModal" tabindex="-1" role="dialog" aria-labelledby="addAddressModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col text-right">
                                    <button type="button" class="close modal-close" data-bs-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true"><i class="fa fa-times"></i></span>
                                    </button>
                                </div>
                            </div>
                            <form id="addAddressForm">
                                <input type="hidden" id="addressId" name="addressId">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="default-form-box mb-20">
                                            <label>Name</label>
                                            <input type="text" id="addressName" name="name" class="form-control">
                                            <div id="addressNameError" class="error-message"></div>
                                        </div>
                                        <div class="default-form-box mb-20">
                                            <label>Address Type</label>
                                            <input type="text" id="addressType" name="addressType" class="form-control">
                                            <div id="addressTypeError" class="error-message"></div>
                                        </div>
                                        <div class="default-form-box mb-20">
                                            <label>City</label>
                                            <input type="text" id="city" name="city" class="form-control">
                                            <div id="cityError" class="error-message"></div>
                                        </div>
                                        <div class="default-form-box mb-20">
                                            <label>Landmark</label>
                                            <input type="text" id="landMark" name="landMark" class="form-control">
                                            <div id="landMarkError" class="error-message"></div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="default-form-box mb-20">
                                            <label>State</label>
                                            <input type="text" id="state" name="state" class="form-control">
                                            <div id="stateError" class="error-message"></div>
                                        </div>
                                        <div class="default-form-box mb-20">
                                            <label>Pin Code</label>
                                            <input type="text" id="pinCode" name="pinCode" class="form-control">
                                            <div id="pinCodeError" class="error-message"></div>
                                        </div>
                                        <div class="default-form-box mb-20">
                                            <label>Mobile</label>
                                            <input type="text" id="mobile" name="mobile" class="form-control">
                                            <div id="mobileError" class="error-message"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-right mt-3">
                                    <button type="submit" class="btn btn-md btn-black-default-hover">Save Address</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    <!-- Edit Address Modal -->
<div class="modal fade" id="editAddressModal" tabindex="-1" role="dialog" aria-labelledby="editAddressModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col text-right">
                            <button type="button" class="close modal-close" data-bs-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true"><i class="fa fa-times"></i></span>
                            </button>
                        </div>
                    </div>
                    <form id="editAddressForm">
                        <input type="hidden" id="editAddressId" name="addressId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="default-form-box mb-20 position-relative">
                                    <label>Name</label>
                                    <input type="text" id="editAddressName" name="name" class="form-control">
                                    <div id="editAddressNameError" class="error-message"></div>
                                </div>
                                <div class="default-form-box mb-20">
                                    <label>Address Type</label>
                                    <input type="text" id="editAddressType" name="addressType" class="form-control">
                                    <div id="editAddressTypeError" class="error-message"></div>
                                </div>
                                <div class="default-form-box mb-20">
                                    <label>City</label>
                                    <input type="text" id="editCity" name="city" class="form-control">
                                    <div id="editCityError" class="error-message"></div>
                                </div>
                                <div class="default-form-box mb-20">
                                    <label>Landmark</label>
                                    <input type="text" id="editLandMark" name="landMark" class="form-control">
                                    <div id="editLandMarkError" class="error-message"></div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="default-form-box mb-20" position="relative">
                                    <label>State</label>
                                    <input type="text" id="editState" name="state" class="form-control">
                                    <div id="editStateError" class="error-message"></div>
                                </div>
                                <div class="default-form-box mb-20">
                                    <label>Pin Code</label>
                                    <input type="text" id="editPinCode" name="pinCode" class="form-control">
                                    <div id="editPinCodeError" class="error-message"></div>
                                </div>
                                <div class="default-form-box mb-20">
                                    <label>Mobile</label>
                                    <input type="text" id="editMobile" name="mobile" class="form-control">
                                    <div id="editMobileError" class="error-message"></div>
                                </div>
                            </div>
                        </div>
                        <div class="text-right mt-3">
                            <button type="submit" class="btn btn-md btn-black-default-hover">Save Changes</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>


    
    <!-- Change Password Modal -->
    <% if (success) { %>
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <% if (!messages) { %>
                <p>Password changed successfully</p>
            <% } else { %>
                <%= messages.success %>
            <% } %>
          <%= messages.success %>
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    <% } %>
    
    <% if (error) { %>
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
          <%= message.error %>
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    <% } %>    
<div class="modal fade" id="changePasswordModal" tabindex="-1" role="dialog" aria-labelledby="changePasswordModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
        <div class="modal-content">
            <div class="flash-message-container"></div>
            <div class="modal-body">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col text-right">
                            <button type="button" class="close modal-close" data-bs-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true"><i class="fa fa-times"></i></span>
                            </button>
                        </div>
                    </div>
                    <h3 class="text-center mb-4">Change Password</h3>
                    <form id="changePasswordForm">
                        <div class="default-form-box mb-3">
                            <label for="current-password">Current Password</label>
                            <input type="password" id="current-password" name="current-password" class="form-control">
                            <div id="currentPasswordError" class="error-message"></div>
                        </div>
                        <div class="default-form-box mb-3">
                            <label for="new-password">New Password</label>
                            <input type="password" id="new-password" name="new-password" class="form-control">
                            <div id="newPasswordError" class="error-message"></div>
                        </div>
                        <div class="default-form-box mb-4">
                            <label for="confirm-new-password">Confirm New Password</label>
                            <input type="password" id="confirm-new-password" name="confirm-new-password" class="form-control">
                            <div id="confirmNewPasswordError" class="error-message"></div>
                        </div>
                        <div class="text-center mb-3">
                            <button type="submit" class="btn btn-md btn-black-default-hover">Change Password</button>
                        </div>
                    </form>                    
                </div>
            </div>
        </div>
    </div>
</div>


    

<%- include("../partials/user/footer") %>
<script src="/javascript/editUserProfile.js" defer></script>
<script src="/javascript/sharedValidation.js" defer></script>
<script src="/javascript/address.js" defer></script>
<script>
    window.ordersData = '<%- ordersData %>';
</script>  
<script src="/javascript/myAccount.js" defer></script>
<script src="/javascript/wallet.js" defer></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
    const copyCodeButton = document.getElementById('copyReferralCode');
    const copyLinkButton = document.getElementById('copyReferralLink');
    const referralCode = document.getElementById('referralCode');
    const referralLink = document.getElementById('referralLink');
    const shareButton = document.getElementById('shareReferralLink');

    function copyToClipboard(text, successMessage) {
        navigator.clipboard.writeText(text).then(function() {
            showSuccess(successMessage);
        }, function(err) {
            console.error('Could not copy text: ', err);
        });
    }

    if (copyCodeButton && referralCode) {
        copyCodeButton.addEventListener('click', function() {
            copyToClipboard(referralCode.textContent, 'Referral code copied to clipboard!');
        });
    }

    if (copyLinkButton && referralLink) {
        copyLinkButton.addEventListener('click', function() {
            copyToClipboard(referralLink.textContent, 'Referral link copied to clipboard!');
        });
    }

    if (shareButton && referralLink) {
        shareButton.addEventListener('click', function(e) {
            e.preventDefault();
            if (navigator.share) {
                navigator.share({
                    title: 'Join me on Our Platform!',
                    text: 'Use my referral link to sign up and get a bonus!',
                    url: referralLink.textContent
                })
                .catch((error) => console.error('Error sharing:', error));
            } else {
                showSuccess(`Share this link: ${referralLink.textContent}`);
            }
        });
    }

    
        function createPagination(totalPages, currentPage, containerId, callback) {
        const container = document.getElementById(containerId);
        container.innerHTML = '';

        for (let i = 1; i <= totalPages; i++) {
            const li = document.createElement('li');
            li.className = `page-item ${i === currentPage ? 'active' : ''}`;
            
            const a = document.createElement('a');
            a.className = 'page-link';
            a.href = '#';
            a.textContent = i;
            a.addEventListener('click', (e) => {
                e.preventDefault();
                callback(i);
            });

            li.appendChild(a);
            container.appendChild(li);
        }
    }

    async function loadOrdersPage(page) {
        try {
            const response = await fetch(`/orders?page=${page}`);
            const data = await response.json();
            // Update the orders table with data.orders
            createPagination(data.totalPages, data.currentPage, 'ordersPagination', loadOrdersPage);
        } catch (error) {
            console.error('Error loading orders:', error);
        }
    }

    async function loadWalletPage(page) {
        try {
            const response = await fetch(`/transactions?page=${page}`);
            const data = await response.json();
            // Update the transactions table with data.transactions
            createPagination(data.totalPages, data.currentPage, 'walletPagination', loadWalletPage);
        } catch (error) {
            console.error('Error loading wallet transactions:', error);
        }
    }

    function showError(message) {
    Swal.fire({
        icon: "error",
        text: message,
        toast: true,
        position: "top-right",
        showConfirmButton: false,
        timerProgressBar: true,
        timer: 3000,
        });
    }

    function showSuccess(message) {
    Swal.fire({
        icon: "success",
        text: message,
        toast: true,
        position: "top-right",
        showConfirmButton: false,
        timerProgressBar: true,
        timer: 3000,
        })
    }

    // Initial load
    loadOrdersPage(1);
    loadWalletPage(1);
    });
</script>    
    